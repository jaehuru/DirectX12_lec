# 그래픽 API를 공부하는 이유

### 1. **그래픽 API란?**
- **정의**: 그래픽 API는 **컴퓨터의 GPU(그래픽 처리 장치)**와 소통하는 도구입니다.
- **역할**: 게임 개발자는 "화면에 삼각형을 그려라", "텍스처를 적용하라" 같은 명령을 내리고, 그래픽 API는 이를 GPU에 전달합니다.
- **예시**: DirectX, OpenGL, Vulkan 등은 이러한 명령을 표준화된 방식으로 제공하는 인터페이스입니다.

---

### 2. **DirectX의 큰 그림**
- **DirectX**는 게임을 만들기 위한 다양한 도구들의 묶음이며, 그 중 **Direct3D**가 3D 그래픽 렌더링을 담당합니다.
  
**기본 흐름**:
1. **GPU 초기화**: GPU와 통신할 준비를 합니다. (DirectX 디바이스 생성)
2. **데이터 준비**:
   - **버텍스 데이터**: 3D 모델의 점(버텍스) 좌표.
   - **텍스처 데이터**: 모델의 표면에 덮을 이미지.
3. **렌더링 파이프라인 설정**: 어떻게 화면에 그릴지 설정합니다. (셰이더, 라이트, 카메라 등)
4. **드로우 호출**: 최종적으로 GPU에 "화면에 그려라" 명령을 내립니다.

---

### 3. **주요 용어와 개념**
- **렌더링(Rendering)**: 화면에 무언가를 그리는 과정입니다.
- **셰이더(Shader)**: GPU에서 실행되는 작은 프로그램으로, 각 점(버텍스)이나 픽셀의 색상, 위치를 계산합니다.
  - **버텍스 셰이더**: 점의 위치를 계산.
  - **픽셀 셰이더**: 점의 색상과 조명을 계산.
- **버퍼(Buffer)**: 데이터를 GPU에 전달하기 위한 메모리 영역입니다. (예: 버텍스 버퍼, 인덱스 버퍼)
- **파이프라인(Pipeline)**: 데이터를 GPU로 보내고 화면에 그리기까지의 과정을 단계별로 정의한 것.

---

### 4. **왜 어렵게 느껴질까?**
- **저수준 작업**: 상용 엔진은 "캐릭터를 화면에 표시한다"는 고수준 작업만 요구하지만, DirectX는 "삼각형을 GPU로 보내고, 셰이더를 작성하고, 색을 계산한다"는 낮은 단계부터 직접 작업해야 해요.
- **복잡한 초기 설정**: DirectX는 GPU와 소통하기 위한 초기화 과정이 길고 복잡합니다. 예를 들어, 윈도우 창을 열고, Direct3D 디바이스를 생성하고, 렌더 타겟을 설정하는 등의 작업이 필요해요.
- **추상화 부족**: 상용 엔진은 "카메라", "라이트" 같은 개념이 추상화되어 있지만, DirectX에서는 이를 모두 수동으로 설정해야 해요.

---

### 5. **어떻게 이해를 쉽게 할까?**
1. **작은 목표로 시작하세요.**
   - **예제 1**: DirectX로 단순히 삼각형 하나를 그려보세요. 이 과정에서 "버텍스 데이터"와 "셰이더"를 배울 수 있습니다.
   - **예제 2**: 삼각형에 텍스처를 입혀보세요. "텍스처 데이터"와 "픽셀 셰이더"를 이해할 수 있습니다.
2. **렌더링 파이프라인의 흐름을 이해하세요.**
   - 데이터를 GPU에 보내서 화면에 표시되는 과정을 그림으로 그려보세요. 
   - **데이터 준비 → 셰이더 처리 → 화면에 그리기.**
3. **샘플 코드 분석**
   - Microsoft의 DirectX SDK나, Frank Luna의 책에서 제공하는 샘플 코드를 실행하고 분석해 보세요.
   - 코드가 어떻게 GPU와 상호작용하는지 확인해 보면 이해가 더 빠를 거예요.
4. **다른 사람의 강의나 튜토리얼 참고**
   - YouTube나 블로그에서 DirectX 튜토리얼을 찾아보면 더 쉽게 이해할 수 있어요. 코드와 시각적인 설명을 병행하면 훨씬 낫습니다.

---

### 6. **DirectX의 실무적 가치**
- **게임 엔진의 내부를 이해**: Unreal Engine이나 Unity 같은 엔진이 내부적으로 DirectX/OpenGL/Vulkan을 기반으로 동작합니다. DirectX를 배우면 엔진의 작동 원리를 더 잘 이해할 수 있어요.
- **최적화와 제어**: 상용 엔진의 한계를 넘어, 게임의 성능을 직접 최적화할 수 있습니다.

---

# DirectX를 배울 때 가장 중요한 부분

### 1. **그래픽 파이프라인 이해**
DirectX는 GPU의 그래픽 파이프라인을 제어하는 도구입니다. 파이프라인의 각 단계를 이해하는 것이 핵심입니다.

#### 1) **입력 단계 (Input Assembler)**:
- **역할**: 버텍스와 인덱스 데이터를 GPU로 전달하는 부분.
- **DirectX에서의 작업**: ID3D11Buffer를 사용하여 데이터를 업로드.

#### 2) **셰이더 단계 (Vertex/Pixel/Geometry Shader)**:
- **HLSL(High-Level Shader Language)**로 작성된 프로그램이 실행됩니다.
- **셰이더**: 각 셰이더는 GPU에서 특정 작업(버텍스 변환, 픽셀 컬러 계산 등)을 수행합니다.

#### 3) **라스터화 단계**:
- **역할**: 3D 데이터를 2D 화면에 그리는 과정.

#### 4) **출력 병합 단계 (Output Merger)**:
- **역할**: 여러 렌더링 결과를 병합하여 최종 화면을 생성.

#### **공부 방법**:
- 각 단계가 하는 역할과 데이터를 처리하는 방식을 이해합니다.
- 샘플 코드를 분석하며 GPU와의 데이터 흐름을 시뮬레이션해 봅니다.

---

### 2. **GPU와의 소통 방식**
DirectX는 GPU와 데이터를 주고받는 다양한 방식을 제공합니다.

#### 1) **디바이스와 디바이스 컨텍스트 생성**:
- **목적**: GPU와의 소통을 시작하려면 DirectX 디바이스(ID3D11Device)와 디바이스 컨텍스트(ID3D11DeviceContext)를 생성해야 합니다.

#### 2) **버퍼 관리**:
- **목적**: 버텍스 버퍼, 인덱스 버퍼, 상수 버퍼를 GPU에 업로드하고 사용하는 방식.
- **성능 최적화**: GPU에 데이터를 업로드할 때 성능 최적화가 중요합니다.
  - **STATIC**: 자주 변경되지 않는 데이터.
  - **DYNAMIC**: 매 프레임 업데이트되는 데이터.

#### 3) **리소스와 셰이더 간의 연결**:
- 셰이더가 데이터를 처리하려면 GPU 리소스(텍스처, 버퍼 등)와 연결되어야 합니다.
- 예: ID3D11ShaderResourceView로 텍스처 연결.

---

### 3. **DirectX의 주요 구성 요소**
DirectX 11/12를 배울 때는 다음 구성 요소를 중점적으로 공부해야 합니다.

#### **DirectX 11**
- **스왑 체인(Swap Chain)**: GPU가 렌더링한 이미지를 화면에 출력하는 역할.
- **렌더 타겟(Render Target)**: GPU가 그리는 최종 이미지의 메모리 공간.
- **셰이더(Shader)**: HLSL로 작성된 GPU 프로그램.
- **텍스처와 서피스(Texture/Surface)**: 텍스처 데이터를 GPU에 업로드하고 사용하는 방법.
- **Blend/Depth/Stencil 상태**: 다양한 렌더링 효과와 최적화를 위한 상태 설정.

#### **DirectX 12 (추가로 중요)**
- **명령 큐(Command Queue)와 명령 리스트(Command List)**: CPU와 GPU의 동작을 병렬로 처리.
- **루트 서명(Root Signature)**: GPU와 데이터를 연결하는 효율적인 방식.

---

### 4. **HLSL(High-Level Shader Language)**
셰이더 프로그래밍은 DirectX에서 핵심입니다.

#### 1) **기본 셰이더 작성**:
- **버텍스 셰이더**: 3D 모델의 버텍스를 처리.
- **픽셀 셰이더**: 화면의 각 픽셀 색을 계산.

#### 2) **셰이더와 CPU 코드 연결**:
- HLSL로 작성된 셰이더를 컴파일하고, DirectX의 API로 연결.

#### 3) **셰이더 디버깅**:
- 디버깅 도구(Visual Studio의 Graphics Debugger)를 활용.

---

### 5. **DirectX와 최적화**
- **GPU와 CPU 간의 동기화**를 최소화하는 방법.
  - 예: GPU 작업이 끝나기를 기다리지 않고 명령을 계속 보내는 방식.
- **멀티스레드 렌더링**: DirectX 12에서는 여러 스레드에서 명령 리스트를 생성해 GPU를 최대한 활용.
- **메모리 관리**: 텍스처와 버퍼를 적절히 관리하여 메모리 사용량을 줄이는 방법.

---

### 6. **실습을 통한 이해**
DirectX는 공부만으로는 어렵기 때문에, 간단한 프로젝트를 만들어 보는 것이 중요합니다.

#### **단계별 프로젝트 예제**:
1. 간단한 삼각형 그리기.
2. 텍스처 추가.
3. 조명 효과 추가(Phong Shading).
4. 카메라와 뷰 행렬 구현.
5. 복잡한 3D 모델 로딩 및 렌더링.

#### **도구 활용**:
- **Visual Studio Graphics Debugger**: GPU 작업을 추적.
- **PIX for Windows**: DirectX 디버깅 및 성능 분석.

---

### 요약
1. **GPU와 소통하는 구조**: 디바이스와 리소스 관리 방식, GPU 파이프라인 이해.
2. **그래픽 파이프라인**: 입력, 셰이더, 출력 단계를 이해하고 구현.
3. **셰이더 작성과 최적화**: HLSL로 셰이더를 작성하고 GPU 성능을 최적화.
4. **실습**: 간단한 렌더링 프로젝트를 직접 구현하며 이해를 확립.
